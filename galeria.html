<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Museu das MemÃ³rias â€“ Galeria</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: linear-gradient(to bottom, #cfcfcf, #f0f0f0);
      font-family: 'Georgia', serif;
      transition: background 0.5s ease;
    }

    body.escuro {
      background: #111;
      color: #eee;
    }

    .memoria {
      position: absolute;
      padding: 10px;
      max-width: 220px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      animation: flutuar 12s ease-in-out infinite;
      text-align: center;
      z-index: 1;
      cursor: pointer;
      backdrop-filter: blur(2px);
      transition: transform 0.3s ease;
    }

    .memoria:hover {
      transform: scale(1.05);
    }

    .memoria[data-tipo="triste"] {
      background-color: rgba(150, 150, 255, 0.2);
      filter: grayscale(60%) contrast(90%);
    }

    .memoria[data-tipo="alegre"] {
      background-color: rgba(255, 250, 200, 0.4);
      filter: brightness(1.1) saturate(1.2);
    }

    .memoria[data-tipo="nostÃ¡lgica"] {
      background-color: rgba(200, 220, 255, 0.3);
      filter: sepia(0.3) contrast(1.1);
    }

    .memoria[data-tipo="reflexiva"] {
      background-color: rgba(210, 240, 255, 0.2);
      filter: grayscale(30%) brightness(1.05);
    }

    .memoria img {
      max-width: 100%;
      border-radius: 8px;
    }

    .texto {
      font-size: 0.9rem;
      margin-top: 8px;
      color: #444;
    }

    @keyframes flutuar {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .poeira {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      background-image: url('https://www.transparenttextures.com/patterns/foggy-birds.png');
      opacity: 0.15;
      z-index: 0;
    }

    .botoes {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 10;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .botoes button {
      position: relative;
      padding: 8px 12px;
      background: rgba(255,255,255,0.8);
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-family: 'Georgia', serif;
      transition: background 0.3s, transform 0.3s;
      animation: pulse 2s infinite alternate;
    }

    .botoes button:hover {
      background: rgba(200,200,200,0.8);
      transform: scale(1.1);
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 5px rgba(0,0,0,0.2); }
      100% { box-shadow: 0 0 15px rgba(0,0,0,0.4); }
    }

    /* Tooltip */
    .botoes button[data-tooltip]:hover::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 130%;
      right: 50%;
      transform: translateX(50%);
      background: rgba(0, 0, 0, 0.75);
      color: white;
      padding: 5px 8px;
      border-radius: 4px;
      white-space: nowrap;
      font-size: 0.8rem;
      pointer-events: none;
      opacity: 1;
      transition: opacity 0.3s ease;
      z-index: 20;
    }
  </style>
</head>
<body>
  <div class="poeira"></div>

  <div class="botoes">
    <button onclick="alternarTema()" data-tooltip="Alterna entre fundo claro e escuro">ðŸŒ™ Alternar fundo</button>
    <button onclick="alternarSom()" data-tooltip="Liga ou desliga o som ambiente">ðŸ”‡ Mutar/Desmutar</button>
  </div>

  <audio id="ambiente" autoplay loop>
    <source src="https://cdn.pixabay.com/audio/2022/10/20/audio_e43f6f30ce.mp3" type="audio/mpeg" />
  </audio>

  <script>
    const memorias = JSON.parse(localStorage.getItem('memorias')) || [];
    const body = document.body;
    const audioAmbiente = document.getElementById('ambiente');

    function alternarTema() {
      body.classList.toggle('escuro');
    }

    function alternarSom() {
      audioAmbiente.muted = !audioAmbiente.muted;
    }

    function classificarMemoria(texto) {
      const categorias = {
        triste: ['perdi', 'saudade', 'triste', 'fim', 'despedida', 'adeus'],
        alegre: ['feliz', 'sorriso', 'alegre', 'presente', 'amor', 'brincava'],
        nostÃ¡lgica: ['infÃ¢ncia', 'lembrava', 'antigamente', 'era crianÃ§a', 'escola'],
        reflexiva: ['mudou', 'aprendi', 'recomeÃ§o', 'transformaÃ§Ã£o', 'entendi']
      };
      const t = texto.toLowerCase();
      for (const tipo in categorias) {
        if (categorias[tipo].some(palavra => t.includes(palavra))) return tipo;
      }
      return '';
    }

    memorias.forEach((memoria, index) => {
      const tipo = classificarMemoria(memoria.texto);
      const div = document.createElement('div');
      div.className = 'memoria';
      if (tipo) div.setAttribute('data-tipo', tipo);

      div.style.top = `${Math.random() * 80 + 5}%`;
      div.style.left = `${Math.random() * 90 + 2}%`;
      div.style.animationDelay = `${Math.random() * 5}s`;

      const img = document.createElement('img');
      img.src = memoria.imagemUrl || '';
      img.alt = 'MemÃ³ria visual';

      const texto = document.createElement('div');
      texto.className = 'texto';
      texto.textContent = memoria.texto;

      div.onclick = () => {
        const utterance = new SpeechSynthesisUtterance(memoria.texto);
        utterance.lang = 'pt-BR';
        if (tipo === 'triste') {
          utterance.pitch = 0.8;
          utterance.rate = 0.9;
        } else if (tipo === 'alegre') {
          utterance.pitch = 1.2;
          utterance.rate = 1.05;
        } else if (tipo === 'nostÃ¡lgica') {
          utterance.pitch = 1.0;
          utterance.rate = 0.95;
        } else if (tipo === 'reflexiva') {
          utterance.pitch = 1.1;
          utterance.rate = 1.0;
        }
        speechSynthesis.speak(utterance);
      };

      div.appendChild(img);
      div.appendChild(texto);
      document.body.appendChild(div);
    });
  </script>
</body>
</html>
